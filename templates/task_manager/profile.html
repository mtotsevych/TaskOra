{% extends "layouts/base.html" %}
{% load static %}

{% block content %}

  <div class="container-fluid">
    <div class="page-header min-height-250 border-radius-lg mt-4 d-flex flex-column justify-content-end">
      <span class="mask bg-primary opacity-9"></span>
      <div class="w-100 position-relative p-3">
        <div class="d-flex justify-content-between align-items-end">
          <div class="d-flex align-items-center">
            <div>
              <h5 class="mb-1 text-white font-weight-bolder">
                {{ worker.first_name }} {{ worker.last_name }}
              </h5>
              <p class="mb-0 text-white text-sm">
                {{ worker.position }}
              </p>
            </div>
          </div>
          {% if worker.id == user.id %}
            <div class="d-flex align-items-center">
              <a href="{% url "task_manager:profile-delete" worker.id %}" class="btn btn-outline-white mb-0 btn-sm">
                Delete account
              </a>
            </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
  <div class="container-fluid py-4">
    <div class="row">
      <div class="col-12 col-xl-4">
        <div class="card h-100" style="min-height: 400px; max-height: 400px; overflow-y: auto;">
          <div class="card-header pb-0 p-3">
            <div class="row">
              <div class="col-md-8 d-flex align-items-center">
                <h6 class="mb-0">Profile Information</h6>
              </div>
              {% if worker.id == user.id %}
                <div class="col-md-4 text-end">
                  <a href="{% url "task_manager:profile-update" user.id %}">
                    <i class="fas fa-user-edit text-secondary text-sm" data-bs-toggle="tooltip" data-bs-placement="top" title="Edit Profile"></i>
                  </a>
                </div>
              {% endif %}
            </div>
          </div>
          <div class="card-body p-3">
            {% if worker.bio %}
              <p class="text-sm">
                {{ worker.bio }}
              </p>
            {% else %}
              <p class="text-sm">
                No bio here.
              </p>
            {% endif %}
            <hr class="horizontal gray-light my-4">
            <ul class="list-group">
              <li class="list-group-item border-0 ps-0 pt-0 text-sm"><strong class="text-dark">Username:</strong> &nbsp; {{ worker.username }}</li>
              <li class="list-group-item border-0 ps-0 text-sm">
                <strong class="text-dark">Full name:</strong> &nbsp; {% if worker.first_name and worker.last_name %} {{ worker.first_name }} {{ worker.last_name }} {% else %} Full name not saved yet. {% endif %}
              </li>
              <li class="list-group-item border-0 ps-0 text-sm"><strong class="text-dark">Email:</strong> &nbsp; {% if worker.email %} {{ worker.email }} {% else %} Email not saved yet. {% endif %}</li>
              <li class="list-group-item border-0 ps-0 text-sm"><strong class="text-dark">Last login:</strong> &nbsp; {% if worker.last_login %} {{ worker.last_login }} {% else %} Not logged in yet. {% endif %}</li>
              <li class="list-group-item border-0 ps-0 text-sm"><strong class="text-dark text-sm">Joined:</strong> &nbsp; {{ worker.date_joined }}</li>
            </ul>
          </div>
        </div>
      </div>
      <div class="col-12 col-xl-8">
        <div class="card">
          <div class="card-header pb-0">
            <div class="row">
              {% if worker.first_name %}
                <div class="col-lg-6 col-7">
                  <h6>{{ worker.first_name }}’s Assignments</h6>
                </div>
              {% else %}
                <div class="col-lg-6 col-7">
                  <h6>Worker’s Assignments</h6>
                </div>
              {% endif %}
            <div class="col-lg-6 col-5 my-auto text-end">
              <div class="dropdown float-lg-end pe-4">
                <a class="cursor-pointer" id="dropdownTable" data-bs-toggle="dropdown" aria-expanded="false">
                  <i class="fa fa-ellipsis-v text-secondary"></i>
                </a>
                <ul class="dropdown-menu dropdown-menu-end px-2 py-3" aria-labelledby="dropdownTable" style="max-width: 100vw !important; overflow-x: auto !important;">
                  <li><a class="dropdown-item border-radius-md" href="{% url "task_manager:profile-detail" worker.id %}">All Tasks</a></li>
                  <li>
                    <form action="" method="get" novalidate>
                      <input type="hidden" name="completed" value="Yes">
                      <input type="submit" class="dropdown-item border-radius-md" value="Completed">
                    </form>
                  </li>
                  <li>
                    <form action="" method="get" novalidate>
                      <input type="hidden" name="completed" value="No">
                      <input type="submit" class="dropdown-item border-radius-md" value="Not Completed">
                    </form>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="card-body px-0 pb-2">
          <div class="table-responsive" style="max-height: 46vh; overflow-y: auto;">
            <table class="table align-items-center mb-0">
              {% if tasks %}
                <thead>
                  <tr>
                    <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Name</th>
                    <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Deadline</th>
                    <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Priority</th>
                    <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Is completed</th>
                  </tr>
                </thead>
                <tbody>
                  {% for task in tasks %}
                    <tr>
                      <td class="align-middle ps-4 py-3">
                        <h6 class="mb-0 text-sm">{{ task.name }}</h6>
                      </td>
                      <td class="align-middle px-2 py-3">
                        <h6 class="mb-0 text-sm">{{ task.deadline }}</h6>
                      </td>
                      <td class="align-middle px-2 py-3 text-center">
                        <h6 class="mb-0 text-sm">{{ task.priority }}</h6>
                      </td>
                      <td class="align-middle px-2 py-3 text-center">
                        {% if task.is_completed %}
                          <h6 class="mb-0 text-sm">Completed</h6>
                        {% else %}
                          <h6 class="mb-0 text-sm">Not Completed</h6>
                        {% endif %}
                      </td>
                    </tr>
                  {% endfor %}
                </tbody>
              {% else %}
                <div class="card-body px-4 py-3">
                  <h6 class="mb-0">There is nothing here.</h6>
                </div>
              {% endif %}
            </table>
          </div>
        </div>
        </div>
      </div>
    </div>
    {% include "includes/footer.html" %}
  </div>

{% endblock content %}
